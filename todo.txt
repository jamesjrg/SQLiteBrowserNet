git changelog:
- make open new db files work, and treeview redraws
- you can close query tabs
- refactor db conn to have its own global static class (Global)
- QueryAndResults now has its own vm, and is renamed (from QueryItems)

todo now:

- manually create mainwindow in app (see unused, and remove starturi, but then apptitle can't bind for some reason)

- change from routedcommands to some other way of routing commands through system? and have definition not in mainwindow.xaml.cs?

- make close command, save command and execute command routed on the queryitems, not the main window

- close tab icons on queries, and hover effects etc

- make treeview lazy loading

- hide resultstabs by default, until attached query is run

- for editing tables, datagrid appears in a tab in queriestabs, not in results tabs.

- messages tab should always appear at end of results tabs or not at all (probably by making the collectionview support sorting). should have actual sqlite messages. should always exist and never actually have its reference removed from resultstabs list, rather just gets filtered from view if it gets closed. should use try/catch to catch sql errors and display them. go to results tab after running query, unless there is an error, in which case hide the results tab and just show the messages tab.

- make the basic treeview of database work - already got tables, now need indexes, etc.  treeview should inc everything from SQLiteConnection.GetSchema 

- make schema treeview let you right click to view schema or contents ultimately these need icons and shortcut keys as well).

- when a query tab is closed, its associated lower tabs also need to be killed

- add some unit tests, and perhaps start doing write test first programming

Plan:
- a bit of a cross between sqlitebrowser and SQL Sever Management Studio, including features from both (where applicable)

UI:
- two bars at top, one is always constant (file, view, help, etc), the other is context sensitive depending on whether focus in object explorer, query window, or results window
- context sensitive things for query: open, save, run, cancel. for results: export, select all, copy, copy with headers. for obj explorer win: view top 200, view all, edit top 200
- have undo/redo for query windows
- rest v similar to msssms - object explorer on left, tabbed query windows windows on top, tabbed results panes and messages panes on bottom. rather than having properties windows from object epxlorer open in new windows, make them open tabs in bottom section as well. also, no properties window on right.
- ideally the various sections are hidable/dockable/resizable/etc
- to query either results or schema of anything in tree, can either right click on tree, or use icon#

tests should test for (ob much of this is not yet implemented):
- blank queries
- erronerous queries - and ensuring error messages correctly appear where they are supposed to
- trying to open a file which isn't a db
- querying when no db is open (or rather, make this impossible)
- all commands and menu options
- allow adding a field named "delete"
- work with tables that have names like at::GeotechnicalMeasurementPoint
- foreign keys

stuff:
- in tree view, icons for different sorts of children (e.g. tables, indexes, etc)
- ctrl t / ctrl f4 open/close query tabs, also closing results/schema tabs
- * in title bar if modified without saving, same with queries
- grey out menu items and toolbar icons when not useable
- have shortcut key listed next to each menu item
- make shortcut keys work
- should be able to execute (or otherwise sensibly error) balnk queries, malformed queries, etc
- tooltips for toolbare and tree and long items in results
- allow select/copy/export of result sets
- exporting either data or result sets give options of ascii, utf, csv ascii, cvs utf8 etc
- should be possible to optionally not lock database file - see SQlite explorer
- allow import from csv, sql, others
- allow export to sql, csv, xml, others
- support transactions
- support extensions
- on-the-fly syntax checking
- search and sort functionality, like sqlite browser
- block commenting, indenting, etc
- does the treeview's virtualization work? is it data virtualization?
- refresh treeview after running query
- highlight sql keywords
- recent databases menu option
- make browser work with tables named "group", and with tables named "8digit"
- save/load queries
- view top 100/1000/all results in browser
- also, look at sql server management studio for other ideas
- many commands should be available in menu, in menu with shortcut, via own app-wide shortcut, and via right clicking
- make resizing with grid splitters work properly at all times
- results panes should be read only, but still selectable and copyable
- messages in messages tab should maybe have icons?
- result tab and messages tab should have icons
- could look at feature lists at http://www.sqlite.org/cvstrac/wiki?p=ManagementTools for more ideas
- execute highlighted text
- execute multiple statements separeted by semi colon

to run requires:
.NET 4 client profile

to compile requires:
.NET 4 SDK
System.Data.SQLite
